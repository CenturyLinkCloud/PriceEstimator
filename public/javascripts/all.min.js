!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){var c;c={NAME:"matt"},b.exports=c},{}],2:[function(a,b){var c,d;d=a("../models/PricingMapModel.coffee"),c=Backbone.Collection.extend({model:d,url:"json/pricing.json",initialize:function(){return this.fetch()},forKey:function(a){return _.first(this.where({type:a}))}}),b.exports=c},{"../models/PricingMapModel.coffee":5}],3:[function(a,b){var c,d;c=a("../models/ServerModel.coffee"),d=Backbone.Collection.extend({model:c,subtotal:function(){return _.reduce(this.models,function(a,b){return a+b.totalPricePerMonth()},0)}}),b.exports=d},{"../models/ServerModel.coffee":6}],4:[function(a,b){var c,d;c=a("../models/ServiceModel.coffee"),d=Backbone.Collection.extend({model:c,url:function(){return this.options.collectionUrl},initialize:function(a){return this.options=a||{},this.fetch()},initPricing:function(a){return this.each(function(){return function(b){var c;return c=a.forKey(b.get("key")),b.initPricing(c)}}(this))},subtotal:function(){return _.reduce(this.models,function(a,b){return a+b.totalPricePerMonth()},0)}}),b.exports=d},{"../models/ServiceModel.coffee":7}],5:[function(a,b){var c;c=Backbone.Model.extend({initialize:function(){}}),b.exports=c},{}],6:[function(a,b){var c;c=Backbone.Model.extend({HOURS_PER_DAY:"hours_per_day",HOURS_PER_WEEK:"hours_per_week",HOURS_PER_MONTH:"hours_per_month",PERCENTAGE_OF_MONTH:"percentage_of_month",HOURS_IN_MONTH:730,defaults:{type:"standard",os:"linux",cpu:1,memory:1,storage:1,quantity:1,usagePeriod:"percentage_of_month",usage:100},initialize:function(){return this.initPricing()},initPricing:function(){var a;return a=this.get("pricingMap").attributes.options,this.set("pricing",a)},totalCpuPerHour:function(){return this.get("cpu")*this.get("pricing").cpu},totalMemoryPerHour:function(){return this.get("memory")*this.get("pricing").memory},totalOSPerHour:function(){return this.get("pricing").os[this.get("os")]*this.get("cpu")},utilityPricePerHourPerInstance:function(){return this.totalCpuPerHour()+this.totalMemoryPerHour()+this.totalOSPerHour()},utilityPricePerHourTotal:function(){return this.utilityPricePerHourPerInstance()*this.get("quantity")},storagePricePerMonth:function(){var a;return a=this.get("type"),this.get("storage")*this.get("pricing").storage[a]*this.get("quantity")},totalPricePerMonth:function(){var a;switch(a=0,this.get("usagePeriod")){case this.HOURS_PER_DAY:a=this.utilityPricePerHourTotal()*this.get("usage")*31;break;case this.HOURS_PER_WEEK:a=this.utilityPricePerHourTotal()*this.get("usage")*4;break;case this.HOURS_PER_MONTH:a=this.utilityPricePerHourTotal()*this.get("usage");break;case this.PERCENTAGE_OF_MONTH:a=Math.round(this.get("usage")/100*this.HOURS_IN_MONTH*this.utilityPricePerHourTotal())}return a+this.storagePricePerMonth()}}),b.exports=c},{}],7:[function(a,b){var c;c=Backbone.Model.extend({defaults:{title:"",description:"",input:"select",quantity:0},initialize:function(){},initPricing:function(a){return this.set("pricing",a.get("price"))},totalPricePerMonth:function(){return this.get("pricing")*this.get("quantity")}}),b.exports=c},{}],8:[function(a,b){b.exports=function(a){return function(){var a,b,c;return b=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/\//g,"&#47;").replace(/"/g,"&quot;")},a=function(a){switch(a){case null:case void 0:return"";case!0:case!1:return""+a;default:return a}},c=[],c.push("<div class='quantity-cell table-cell'>\n  <input class='number' name='quantity' value='"+b(a(this.model.get("quantity")))+"' type='text'>\n</div>\n<div class='table-cell usage-cell'>\n  <input class='number' name='usage' value='"+b(a(this.model.get("usage")))+"' type='text'>\n  <select name='usagePeriod'>\n    <option value='hours_per_month' selected='"+b(a("hours_per_month"===this.model.get("usagePeriod")))+"'>hrs / month</option>\n    <option value='percentage_of_month' selected='"+b(a("percentage_of_month"===this.model.get("usagePeriod")))+"'>% / month</option>\n    <option value='hours_per_week' selected='"+b(a("hours_per_week"===this.model.get("usagePeriod")))+"'>hrs / week</option>\n    <option value='hours_per_day' selected='"+b(a("hours_per_day"===this.model.get("usagePeriod")))+"'>hrs / day</option>\n  </select>\n</div>"),c.push("hyperscale"===this.model.get("type")?"<input type='hidden' value='hyperscale'>":"<div class='table-cell type-cell'>\n  <select name='type'>\n    <option value='standard' selected='"+b(a("standard"===this.model.get("type")))+"'>standard</option>\n    <option value='premium' selected='"+b(a("premium"===this.model.get("type")))+"'>premium</option>\n  </select>\n</div>"),c.push("<div class='os-cell table-cell'>\n  <select name='os'>\n    <option value='linux' selected='"+b(a("linux"===this.model.get("os")))+"'>Linux</option>\n    <option value='redhat' selected='"+b(a("redhat"===this.model.get("os")))+"'>Red Hat</option>\n    <option value='windows' selected='"+b(a("windows"===this.model.get("os")))+"'>Windows</option>\n  </select>\n</div>\n<div class='cpu-cell range-cell table-cell'>\n  <span class='cpu'>"+b(a(this.model.get("cpu")))+"</span>\n  <!-- %input.cpu.text-slider-input{name: \"cpuText\", value: @model.get(\"cpu\")} -->\n  <input class='range-slider' name='cpu' type='range' min='"+b(a(1))+"' max='"+b(a(16))+"' value='"+b(a(this.model.get("cpu")))+"'>\n</div>\n<div class='memory-cell range-cell table-cell'>\n  <span class='memory'>"+b(a(this.model.get("memory")))+"</span>\n  <input class='range-slider' name='memory' type='range' min='"+b(a(1))+"' max='"+b(a(128))+"' value='"+b(a(this.model.get("memory")))+"'>\n</div>\n<div class='range-cell storage-cell table-cell'>\n  <!-- %span.storage= @model.get(\"storage\") -->\n  <input class='storage-text-input' data-name='storage'>"),c.push("hyperscale"===this.model.get("type")?"  <input class='range-slider' name='storage' type='range' min='"+b(a(1))+"' max='"+b(a(160))+"' value='"+b(a(this.model.get("storage")))+"'>":"  <input class='range-slider' name='storage' type='range' min='"+b(a(1))+"' max='"+b(a(4e3))+"' step='"+b(a(1))+"' value='"+b(a(this.model.get("storage")))+"'>"),c.push("</div>\n<div class='price-cell table-cell'>\n  <span class='price'>"),c.push("    "+b(a(accounting.formatMoney(this.model.totalPricePerMonth())))),c.push("  </span>\n  <a class='remove-button' href='#'>X</a>\n</div>"),c.join("\n").replace(/\s(\w+)='true'/gm," $1").replace(/\s(\w+)='false'/gm,"").replace(/\s(?:id|class)=(['"])(\1)/gm,"")}.call(a)}},{}],9:[function(a,b){b.exports=function(a){return function(){var a,b,c;return b=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/\//g,"&#47;").replace(/"/g,"&quot;")},a=function(a){switch(a){case null:case void 0:return"";case!0:case!1:return""+a;default:return a}},c=[],c.push("<form>\n  <div class='service__info'>\n    <h4>"+b(a(this.model.get("title")))+"</h4>"),this.model.get("description")&&(c.push("    <div class='service__description'>\n      <p>"),c.push("        "+b(a(this.model.get("description")))),this.model.get("link")&&c.push("        <br>\n        <a href='"+b(a(this.model.get("link")))+"' target='_blank'>more info</a>"),c.push("      </p>\n    </div>")),c.push("  </div>\n  <div class='"+["service__inputs",""+b(a(this.model.get("input")))].sort().join(" ").replace(/^\s+|\s+$/g,"")+"'>"),"slider"===this.model.get("input")?(c.push("    <div class='quantity-wrapper'>\n      <span class='quantity'>"),c.push("        "+b(a(this.model.get("quantity")))),c.push("      </span>\n      GB\n    </div>\n    <input class='range-slider' type='range' name='quantity' min='"+b(a(0))+"' max='"+b(a(1e4))+"' value='"+b(a(this.model.get("quantity")))+"'>")):(c.push("    <span class='select'></span>\n    QTY\n      <select name='quantity'>\n        <option>0</option>\n        <option>1</option>\n        <option>2</option>\n        <option>3</option>\n        <option>4</option>\n        <option>5</option>\n      </select>\n      x"),c.push("      "+b(a(accounting.formatMoney(this.model.get("pricing")))))),c.push("    <span class='price'>"),c.push("      "+b(a(accounting.formatMoney(this.model.totalPricePerMonth)))),c.push("    </span>\n  </div>\n</form>"),c.join("\n").replace(/\s(\w+)='true'/gm," $1").replace(/\s(\w+)='false'/gm,"").replace(/\s(?:id|class)=(['"])(\1)/gm,"")}.call(a)}},{}],10:[function(a,b){var c;c=Backbone.View.extend({el:"#monthly-total",events:{"click .add-button":"addServer"},initialize:function(a){return this.options=a||{},this.options.app.on("totalPriceUpdated",function(a){return function(){return a.updateTotal()}}(this)),$(window).scroll(function(a){return function(){return a.positionHeader()}}(this))},updateTotal:function(){return $(".price",this.$el).html(accounting.formatMoney(this.options.app.totalPriceWithSupport))},positionHeader:function(){return $(window).scrollTop()>289?this.$el.css("position","fixed"):this.$el.css("position","absolute")}}),b.exports=c},{}],11:[function(a,b){var c;c=Backbone.View.extend({tagName:"form",className:"table-row",events:{"keypress .number":"ensureNumber","click .remove-button":"removeServer","change select[name]":"onFormChanged","change input[name]":"onFormChanged","input input[name]":"onFormChanged","keyup input[name]":"onFormChanged","keypress input:not([name])":"ensureNumber","input input:not([name])":"onSliderTextChanged"},initialize:function(){return this.model.on("change",function(a){return function(b){return a.onModelChange(b)}}(this))},render:function(){var b;return b=a("../templates/server.haml"),this.$el.html(b({model:this.model})),this.$el.attr("id",this.model.cid),_.defer(function(a){return function(){return $(".range-slider",a.$el).rangeslider({polyfill:!1}),$(".range-slider",a.$el).css("opacity",1)}}(this)),this},removeServer:function(a){return a.preventDefault(),this.model.destroy()},ensureNumber:function(a){var b;return b=a.which?a.which:a.keyCode,!(b>31&&(48>b||b>57))},onSliderTextChanged:function(a){var b,c,d;return b=$(a.currentTarget),c=b.data("name"),d=b.val(),$("[name="+c+"]",this.$el).val(d).change()},onFormChanged:function(a){var b;return a.preventDefault(),b=Backbone.Syphon.serialize(this),this.model.set(b)},onModelChange:function(a){return $(".price",this.$el).html(accounting.formatMoney(a.totalPricePerMonth())),$(".cpu",this.$el).html(a.get("cpu")),$(".memory",this.$el).html(a.get("memory")),$(".storage",this.$el).html(a.get("storage")),$(".storage-text-input",this.$el).val(a.get("storage"))}}),b.exports=c},{"../templates/server.haml":8}],12:[function(a,b){var c,d,e;d=a("./ServerView.coffee"),c=a("../models/ServerModel.coffee"),e=Backbone.View.extend({events:{"click .add-button":"addServer"},initialize:function(a){return this.options=a||{},this.collection.on("add",function(a){return function(b){return a.onServerAdded(b)}}(this)),this.collection.on("remove",function(a){return function(b){return a.onServerRemoved(b)}}(this)),this.collection.on("change",function(a){return function(){return a.updateSubtotal()}}(this)),this.updateSubtotal(),$(".has-tooltip",this.$el).tooltip()},addServer:function(a){var b;return a&&a.preventDefault(),b=this.options.hyperscale===!0?"hyperscale":"standard",this.collection.add({pricingMap:this.options.pricingMap,type:b})},onServerAdded:function(a){var b;return b=new d({model:a}),$(".table",this.$el).append(b.render().el),this.updateSubtotal()},onServerRemoved:function(a){return $("#"+a.cid,this.$el).remove(),this.updateSubtotal()},updateSubtotal:function(){return $(".subtotal",this.$el).html(accounting.formatMoney(this.collection.subtotal()))}}),b.exports=e},{"../models/ServerModel.coffee":6,"./ServerView.coffee":11}],13:[function(a,b){var c;c=Backbone.View.extend({className:"service",events:{"change select":"onFormChanged","change input":"onFormChanged","input input":"onFormChanged"},initialize:function(){return this.model.on("change",function(a){return function(b){return a.onModelChange(b)}}(this))},render:function(){var b;return b=a("../templates/service.haml"),this.$el.html(b({model:this.model})),this.$el.attr("id",this.model.cid),this.$el.addClass(this.model.get("key")),_.defer(function(a){return function(){return $(".range-slider",a.$el).rangeslider({polyfill:!1}),$(".range-slider",a.$el).css("opacity",1)}}(this)),this},onFormChanged:function(a){var b;return a.preventDefault(),b=Backbone.Syphon.serialize(this),this.model.set(b)},onModelChange:function(a){return $(".price",this.$el).html(accounting.formatMoney(a.totalPricePerMonth())),$(".quantity",this.$el).html(a.get("quantity")),a.get("quantity")>0?this.$el.addClass("active"):this.$el.removeClass("active")}}),b.exports=c},{"../templates/service.haml":9}],14:[function(a,b){var c,d,e;d=a("./ServiceView.coffee"),c=a("../models/ServiceModel.coffee"),e=Backbone.View.extend({initialize:function(a){return this.options=a||{},this.collection.on("reset",function(a){return function(){return a.$el.html(""),a.addServices()}}(this)),this.collection.on("change",function(a){return function(){return a.updateSubtotal()}}(this)),this.addServices(),this.updateSubtotal()},addServices:function(){return this.collection.each(function(a){return function(b){var c;return c=new d({model:b}),$(".services",a.$el).append(c.render().el)}}(this))},updateSubtotal:function(){return $(".subtotal",this.$el).html(accounting.formatMoney(this.collection.subtotal()))}}),b.exports=e},{"../models/ServiceModel.coffee":7,"./ServiceView.coffee":13}],15:[function(a,b){var c;c=Backbone.View.extend({el:"#support",events:{"click .support-select":"onSupportSelectClick","click .support-select a":"onSupportSelectInnerLinkClick"},initialize:function(a){return this.options=a||{},this.selectPlan("developer")},onSupportSelectClick:function(a){var b,c;return a.preventDefault(),a.stopPropagation(),b=$(a.currentTarget),c=b.data("plan"),this.selectPlan(c),this.options.app.updateTotalPrice()},onSupportSelectInnerLinkClick:function(a){return a.stopPropagation()},selectPlan:function(a){return this.currentPlan=a,$(".support-select").removeClass("selected"),$(".support-select .status-label").html("Select"),$(".support-select[data-plan="+a+"]").addClass("selected"),$(".support-select[data-plan="+a+"] .status-label").html("Selected"),this.updateSubtotal()},calculateSupportBill:function(){var a,b,c,d,e;return"developer"===this.currentPlan?0:(a=this.options.app.totalPrice||0,d=[1e4,8e4,25e4,1e6],c=[.1,.07,.05,.03],b=_.map(d,function(b,e){var f;return f=d[e-1]||null,0===e&&b>a?[a,c[e]]:f>a?null:b>a?[a-f,c[e]]:[b-f,c[e]]}),e=0,_.map(b,function(a){return a?e=Math.round(e+a[0]*a[1]):void 0}),e)},updateSubtotal:function(){return this.supportPrice=this.calculateSupportBill(),$(".subtotal",this.$el).html(accounting.formatMoney(this.supportPrice)),this.supportPrice}}),b.exports=c},{}],16:[function(a){var b,c,d,e,f,g,h,i,j,k;c=a("./app/Config.coffee"),g=a("./app/views/ServersView.coffee"),k=a("./app/views/SupportView.coffee"),j=a("./app/views/ServicesView.coffee"),d=a("./app/views/MonthlyTotalView.coffee"),e=a("./app/collections/PricingMapsCollection.coffee"),f=a("./app/collections/ServersCollection.coffee"),i=a("./app/collections/ServicesCollection.coffee"),h=a("./app/models/ServiceModel.coffee"),b={initialized:!1,init:function(){return _.extend(this,Backbone.Events),this.monthlyTotalView=new d({app:this}),this.supportView=new k({app:this}),this.pricingMaps=new e,this.pricingMaps.on("sync",function(a){return function(){return a.onPricingMapsSynced()}}(this))},onPricingMapsSynced:function(){return this.initServers(),this.initHyperscaleServers(),this.networkingServices=new i({collectionUrl:"json/networking-services.json"}),this.additionalServices=new i({collectionUrl:"json/additional-services.json"}),this.bandwidthServices=new i({collectionUrl:"json/bandwidth.json"}),this.networkingServices.on("sync",function(a){return function(){return a.initNetworkServices()}}(this)),this.additionalServices.on("sync",function(a){return function(){return a.initAdditionalServices()}}(this)),this.bandwidthServices.on("sync",function(a){return function(){return a.initBandwidthServices()}}(this))},initNetworkServices:function(){return this.networkingServices.initPricing(this.pricingMaps),this.networkingServicesView=new j({collection:this.networkingServices,el:"#networking-services"}),this.networkingServices.on("change",function(a){return function(){return a.updateTotalPrice()}}(this)),this.initialized=!0,this.updateTotalPrice()},initAdditionalServices:function(){return this.additionalServices.initPricing(this.pricingMaps),this.additionalServicesView=new j({collection:this.additionalServices,el:"#additional-services"}),this.additionalServices.on("change",function(a){return function(){return a.updateTotalPrice()}}(this)),this.initialized=!0,this.updateTotalPrice(),$(".main-container").addClass("visible"),$(".spinner").hide()},initBandwidthServices:function(){return this.bandwidthServices.initPricing(this.pricingMaps),this.bandwidthServicesView=new j({collection:this.bandwidthServices,el:"#bandwidth"}),this.bandwidthServices.on("change",function(a){return function(){return a.updateTotalPrice()}}(this)),this.initialized=!0,this.updateTotalPrice()},initServers:function(){return this.serversCollection=new f,this.serversCollection.on("change remove add",function(a){return function(){return a.updateTotalPrice()}}(this)),this.serversView=new g({collection:this.serversCollection,el:"#servers",pricingMap:this.pricingMaps.forKey("server")})},initHyperscaleServers:function(){return this.hyperscaleServersCollection=new f,this.hyperscaleServersCollection.on("change remove add",function(a){return function(){return a.updateTotalPrice()}}(this)),this.hyperscaleServersView=new g({collection:this.hyperscaleServersCollection,el:"#hyperscale-servers",pricingMap:this.pricingMaps.forKey("server"),hyperscale:!0})},updateTotalPrice:function(){return this.initialized?(this.totalPrice=this.serversCollection.subtotal()+this.hyperscaleServersCollection.subtotal()+this.networkingServices.subtotal()+this.additionalServices.subtotal()+this.bandwidthServices.subtotal(),this.totalPriceWithSupport=this.totalPrice+this.supportView.updateSubtotal(),this.trigger("totalPriceUpdated")):void 0}},$(function(){return b.init()})},{"./app/Config.coffee":1,"./app/collections/PricingMapsCollection.coffee":2,"./app/collections/ServersCollection.coffee":3,"./app/collections/ServicesCollection.coffee":4,"./app/models/ServiceModel.coffee":7,"./app/views/MonthlyTotalView.coffee":10,"./app/views/ServersView.coffee":12,"./app/views/ServicesView.coffee":14,"./app/views/SupportView.coffee":15}]},{},[16]);